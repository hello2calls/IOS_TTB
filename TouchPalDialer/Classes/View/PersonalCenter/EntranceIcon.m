////  PersonalCenterEntranceView.m//  TouchPalDialer////  Created by 袁超 on 15/2/7.////#import "EntranceIcon.h"#import "FunctionUtility.h"#import "TPDialerResourceManager.h"#import "UserDefaultsManager.h"#import "NoahManager.h"#import "UsageConst.h"@interface EntranceIcon()    @property (nonatomic, retain) UIButton *bgView;@property (nonatomic, retain) UIView *iconView;@end@implementation EntranceIcon{    UIImageView *imageView;}@synthesize delegate;- (id) initWithFrame:(CGRect)frame {    self = [super initWithFrame:frame];    if (self) {        CGFloat radius = 25;        CGFloat startX = (frame.size.width - radius) / 2 - 0.5;        CGFloat startY = (frame.size.height - radius) / 2;        _bgView = [[UIButton alloc] initWithFrame: CGRectMake(startX, startY, radius, radius)];        _bgView.layer.cornerRadius = radius / 2;        _bgView.backgroundColor = [TPDialerResourceManager getColorForStyle:@"tp_black_color"];        _bgView.alpha = 0;        [self addSubview:_bgView];                imageView = [[UIImageView alloc] initWithFrame:CGRectMake(startX, startY, radius, radius)];        imageView.image = [[TPDialerResourceManager sharedManager]getImageByName:@"personnal_center_icon@2x.png"];        imageView.backgroundColor = [UIColor clearColor];        [self addSubview:imageView];                UIButton *actionBut = [[UIButton alloc]initWithFrame:CGRectMake (0,0,frame.size.width, frame                                                                         .size.height)];        [actionBut addTarget:self action:@selector(onClickDown) forControlEvents:UIControlEventTouchDown];        [actionBut addTarget:self action:@selector(onClickOutsideUp) forControlEvents:UIControlEventTouchUpOutside];        [actionBut addTarget:self action:@selector(onClickOutsideUp) forControlEvents:UIControlEventTouchCancel];        [actionBut addTarget:self action:@selector(onClickInsideUp) forControlEvents:UIControlEventTouchUpInside];        [self addSubview:actionBut];                [self addGuideHint];        [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(refresh) name:GUIDEPOINT_DIALER_MENU object:nil];            }        return self;}- (void)refresh {    BOOL menuShown = [UserDefaultsManager boolValueForKey:SHOULD_MENU_POINT_SHOW defaultValue:YES];    int menuType = PTHide;    if (menuShown) {        menuType = [[NoahManager sharedPSInstance] getGuidePointType:GUIDEPOINT_DIALER_MENU];    }    if (menuType > PTHide && _iconView.hidden) {        _iconView.hidden = NO;        [[NoahManager sharedPSInstance] getGuidePointShown:GUIDEPOINT_DIALER_MENU];    } else if (menuType <= PTHide && !_iconView.hidden) {        _iconView.hidden = YES;    }}- (void) addGuideHint {    _iconView = [[UIView alloc] initWithFrame:CGRectMake(self.frame.size.width - 16,8, 8,8)];    _iconView.layer.masksToBounds = YES;    _iconView.layer.cornerRadius = 4;    _iconView.backgroundColor = [TPDialerResourceManager getColorForStyle:@"tp_red_1_color"];    _iconView.hidden = YES;    [self addSubview:_iconView];}- (void)onClickInsideUp{    _bgView.alpha = 0;    [[NoahManager sharedPSInstance]getGuidePointClicked:GUIDEPOINT_DIALER_MENU];    if ([UserDefaultsManager boolValueForKey:SHOULD_MENU_POINT_SHOW defaultValue:YES]) {        [UserDefaultsManager setBoolValue:NO forKey:SHOULD_MENU_POINT_SHOW];        [[NSNotificationCenter defaultCenter] postNotificationName:GUIDEPOINT_DIALER_MENU object:nil];    }    [self.delegate onEntranceClick];}- (void)onClickOutsideUp {    _bgView.alpha = 0;}- (void)onClickDown {    _bgView.alpha = 0.1;}- (id)selfSkinChange:(NSString *)style{    imageView.image = [TPDialerResourceManager getImage:@"personnal_center_icon@2x.png"];    NSNumber *toTop = [NSNumber numberWithBool:YES];    return toTop;}@end